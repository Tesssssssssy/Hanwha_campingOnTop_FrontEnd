<!doctype html>
<html class="no-js" xmlns:og="http://ogp.me/ns#" xml:lang="ko" lang="ko">

<head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#">
  <meta http-equiv="X-UA-Compatible" content="IE=EmulateIE10,chrome=1" />
  <meta charset="UTF-8">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">

  <title>장바구니</title>

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css"
    integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N" crossorigin="anonymous">

  <script src="//ajax.googleapis.com/ajax/libs/jquery/3.7.0/jquery.min.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
  <script src="/assets/js/script23.js?v=60821"></script>

  <script src="/assets/js/datepicker-ko.js"></script>

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.css" />
  <script src="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.js"></script><!-- Facebook Pixel Code -->

  <link rel="stylesheet" type="text/css" href="/assets/css/header.css">
  <link rel="stylesheet" type="text/css" href="/assets/css/main.css">
  <link rel="stylesheet" type="text/css" href="/assets/css/footer.css">
  <link rel="stylesheet" type="text/css" href="/assets/css/cart.css">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>

<body class="index">
  <div id="fb-root"></div>
  <header id="header">
    <div class="navbar_menu">
      <button class="btn" type="button" id="menu_close">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-x-lg"
          viewBox="0 0 16 16">
          <path
            d="M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8 2.146 2.854Z" />
        </svg>
      </button>
      <ul class="navbar_nav">
        <li class="nav-item active">
          <a href="#">좋아요</a>
        </li>
        <li class="nav-item">
          <a href="#" target="_blank">장바구니</a>

        </li>
        <li class="nav-item">
          <a href="#" target="_blank">로그아웃</a>
        </li>
        
      </ul>
    </div>

    <div class="top_wrapper fixed-top">
      <div class="header_right_m">
        <a href="#" class="btn_noti btn">
          <img src="/assets/images/header/bell-solid.svg" alt="" height="21" />
        </a>

        <button class="btn" id="btn_menu"><img src="/assets/images/header/bars-solid.svg" alt="Menu"
            height="21" /></button>
      </div>


      <ul class="top_menu nav justify-content-end">
        <li class="nav-item">
          <div class="header_right my-auto">
            <div class="login">
              <a href="login.html" class="btn" id="btn_login">
                <img src="/assets/images/header/user-solid.svg" alt="로그인" width="21" />
                로그인
              </a>
            </div>
          </div>
        </li>
        <li class="nav-item">
          <div class="header_right my-auto" id="sub_mymenu" style="display: none;">
            <div class="login">
              <div class="dropdown">
                <a href="home.html" class="btn dropdown-toggle" id="btn_logout" data-toggle="dropdown"
                  aria-haspopup="true">
                  <img src="/assets/images/header/user-solid.svg" alt="로그아웃" width="21" />
                  <span id="user_nickname"></span>
                </a>
                <div class="dropdown-menu" aria-labelledby="btn_logout">
                  <a class="dropdown-item" href="mypage.html">좋아요</a>
                  <a class="dropdown-item" href="mypage.html">장바구니</a>
                  <a class="dropdown-item" href="home.html" onclick="logout()">로그아웃</a>
                </div>
              </div>
            </div>
          </div>
        </li>

        <li class="nav-item">
          <a href="#" class="nav-link wehomehost_btn btn">호스트되기</a>
        </li>
      </ul>

      <div class="head_logo">
        <a href="#" class="logo my-auto"><img src="/assets/images/home/logo.png" alt="Welcome home! Wehome"
            width="111" /></a>
      </div>
  </header>

  <main id="main">
    <section class="cart">
      <div class="cart__information">
        <h1>장바구니</h1>
        <ul>

          <li>장바구니 상품은 최대 30일간 저장됩니다.</li>
          <li>가격, 옵션 등 정보가 변경된 경우 주문이 불가할 수 있습니다.</li>
          <li>환불여부는 예약 시 동의한 ‘취소환불규정’에 따릅니다.</li>
          <li style="color: red;">캠핑온탑은 단건 결제만 가능합니다.</li>
        </ul>
      </div>

      <table class="cart__list">
        <thead>
          <tr>
            <td><input type="checkbox" /></td>
            <td colspan="2">상품 정보</td>
            <td>옵션</td>
            <td>상품 금액</td>
            <td>체크인</td>
            <td>체크아웃</td>
          </tr>
        </thead>

        <tbody id="cartTableBody">
          <tr v-for="cartItem in cartList" :key="cartItem.id">
            <td><input type="checkbox" /></td>
            <td colspan="2">
              <img v-if="cartItem.getFindHouseDtoResList.length > 0"
                :src="cartItem.getFindHouseDtoResList[0].filenames[0]" alt="Product Image" style="width: 50px;">
              <span>{{ cartItem.getFindHouseDtoResList[0].name }}</span>
            </td>
            <td>{{ cartItem.getFindHouseDtoResList[0].content }}</td>
            <td>{{ cartItem.price.toLocaleString() }}원</td>
            <td>{{ cartItem.checkIn }}</td>
            <td>{{ cartItem.checkOut }}</td>
          </tr>
        </tbody>

        <!-- 테이블 푸터 -->
        <tfoot>
          <tr>
            <td colspan="3">
              <button class="cart__list__optionbtn">선택상품 삭제</button>
            </td>
            <td>
              <h2 id="tfoot_message"></h2>
            </td>
            <!-- 예악된 상품이 없습니다. 장바구니 상품이 등록되면 동적으로 메시지가 사라지게 구현. -->
            <td></td>
            <td></td>
          </tr>
        </tfoot>
      </table>
      <div class="cart__mainbtns">
        <button class="cart__bigorderbtn right">결제하기</button>
      </div>
    </section>
  </main>


  <nav>
    <div class="container">
      <div class="row">
        <a href="#" class="col on">
          <div class="button_wrap">
            <img src="/assets/images/home/nav/campground-solid.svg" alt="Home" class="over" width="100%" />
          </div>
          <h2>캠핑온탑</h2>
        </a>
        <a href="#" class="col">
          <div class="button_wrap">
            <img src="/assets/images/home/nav/btn_book.png" alt="Booking" class="off" width="100%" />
            <img src="/assets/images/home/nav/btn_book_h.png" alt="Booking" class="over" width="100%" />
          </div>
          <h2>예약</h2>
        </a>
        <a href="#" class="col">
          <div class="button_wrap">
            <img src="/assets/images/home/nav/btn_msg.png" alt="Message" class="off" width="100%" />
            <img src="/assets/images/home/nav/btn_msg_h.png" alt="Message" class="over" width="100%" />
          </div>
          <h2>메시지</h2>
        </a>
        <a href="#" class="col">
          <div class="button_wrap">
            <img src="/assets/images/home/nav/btn_profile.png" alt="Profile" class="off" width="100%" />
            <img src="/assets/images/home/nav/btn_profile_h.png" alt="Profile" class="over" width="100%" />
          </div>
          <h2>
            로그인
          </h2>
        </a>
      </div>
    </div>
  </nav>

  <!-- PC TOP 버튼 HTML -->
  <div onclick="topFunction()" id="scrollTopPc" class="hidden-md hidden-sm hidden-xs">
    <img src="/assets/images/home/btn_up_light.png">
  </div>
  <!-- 모바일 TOP 버튼 HTML -->
  <div onclick="topFunctionMob()" id="scrollTopMob" class="hidden-lg">
    <img src="/assets/images/home/btn_up_light.png">
  </div>
  <!-- PC DOWN 버튼 HTML -->
  <div onclick="downFunction()" id="scrollDownPc" class="hidden-md hidden-sm hidden-xs">
    <img src="/assets/images/home/btn_down_light.png">
  </div>
  <!-- 모바일 DOWN 버튼 HTML -->
  <div onclick="downFunctionMob()" id="scrollDownMob" class="hidden-lg">
    <img src="/assets/images/home/btn_down_light.png">
  </div>

  <footer id="footer">
    <div class="container-fluid">
      <div class="row">
        <div class="col-sm">
          <div class="row">
            <div class="col">
              <dl>
                <dt>고객서비스</dt>
                <dd><a href="#">연락처</a></dd>
                <dd><a href="#" target="_blank">이용약관</a></dd>
                <dd><a href="#">개인정보보호정책</a></dd>
                <dd><a href="#" target="_blank">공유숙박 실증특례</a></dd>

              </dl>
            </div>
            <div class="col">
              <dl>
                <dt>캠핑온탑 소개</dt>
                <dd><a href="#">회사 소개</a></dd>
                <dd><a href="#">팀 소개</a></dd>
                <dd><a href="#">인재채용</a></dd>
                <dd><a href="#">언론보도</a></dd>
              </dl>
            </div>
          </div>
        </div>
        <div class="col">
          <dl>
            <dt>커뮤니티</dt>
            <div class="sns_link">

              <span><a href="http://facebook.com" target="_blank" title="Facebook"
                  onclick="window.dataLayer.push({event: 'sns_click',channel: 'facebook'});"><img
                    src="/assets/images/footer/ic_facebook.gif" alt="Facebook" width="24" /></a></span>
              <span><a href="https://www.instagram.com" target="_blank" title="Instagram"
                  onclick="window.dataLayer.push({event: 'sns_click',channel: 'instagram'});"><img
                    src="/assets/images/footer/ic_instagram.gif" alt="Instagram" width="24" /></a></span>
              <span><a href="https://www.youtube.com" target="_blank" title="Youtube"
                  onclick="window.dataLayer.push({event: 'sns_click',channel: 'youtube'});"><img
                    src="/assets/images/footer/ic_youtube.gif" alt="YouTube" width="24" /></a></span>

              <span><a href="https://twitter.com" target="_blank" title="Twitter"
                  onclick="window.dataLayer.push({event: 'sns_click',channel: 'twitter'});"><img
                    src="/assets/images/footer/ic_twitter.gif" alt="Twitter" width="24" /></a></span>
              <span><a href="https://blog.naver.com" target="_blank" title="Blog"
                  onclick="window.dataLayer.push({event: 'sns_click',channel: 'naverblog'});"><img
                    src="/assets/images/footer/ic_blog.gif" alt="Blog" width="24" /></a></span>
            </div>

            <div class="app_link">
              <a href="https://apps.apple.com" target="_blank"
                onclick="window.dataLayer.push({event: 'app_link',channel: 'Apple app store'});"><img
                  src="/assets/images/footer/btn_appstore.png" alt="App Store" /></a>
              <a href="https://play.google.com/store" target="_blank"
                onclick="window.dataLayer.push({event: 'app_link',channel: 'Google play store'});"><img
                  src="/assets/images/footer/btn_playstore.png" alt="Play Store" /></a>
            </div>

          </dl>
        </div>
      </div>
      <div class="row">
        <div class="col">
          <img src="/assets/images/footer/ic_visa.png" alt="Visa" width="50" />
          <img src="/assets/images/footer/ic_master.png" alt="Master" width="50" />
          <img src="/assets/images/footer/ic_amex.png" alt="American Express" width="50" />
          <img src="/assets/images/footer/ic_kakaopay.png" alt="Kakao Pay" width="50" />
          <img src="/assets/images/footer/ic_chaipay.png" alt="Chai Pay" width="50" />
        </div>

      </div>
    </div>
    <div class="copyright">
      <address>
        회사명 (주)캠핑온탑 | 대표 임태우 | 개인정보보호책임자 길민석 | 사업자등록번호 000-00-00000 | 과학기술정통부 공유숙박 규제특례 번호 0000-00-0호 | 통신판매업
        신고번호
        0000-서울동작-0000 | 관광사업등록번호 서울동작0000-00000 | 공유도시서울지정번호 서울시지정 제 000호 | 벤처기업등록번호 제000000000000000
        <br /><br />
        고객센터: 0000-0000 운영시간: 평일 10시~12시 / 13시~18시 (주말, 공유일 휴무)<br />
        주소: 서울특별시 동작구 보라매로 87 플레이데이터 3층 <br />
        이메일: zofnapf@naver.com | 사업제휴문의: zofnapf@naver.com
      </address>
      <p class="disclaim">
        캠핑온탑은 통신판매중개자이며 통신판매의 당사자가 아닙니다. 따라서 상품·거래정보 및 거래에 대하여 책임을 지지않습니다. </p>
      <p>
        &copy;2020 - 2024 wehome. All rights reserved </p>
    </div>
  </footer>

  <div class="modal fade" id="loading">
    <div class="modal-dialog modal-dialog-centered">
      <div style="margin:0 auto;">
        <div class="spinner-border">
          <span class="sr-only">Loading...</span>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
  <script src="/assets/js/cart.js"></script>
  <script>
    let token = window.localStorage.getItem('token');
    var isLoggedIn = token !== null;

    function toggleMenu() {
      var loginButton = document.getElementById('btn_login');
      var logoutButton = document.getElementById('btn_logout');
      var myMenu = document.getElementById('sub_mymenu');
      var userNicknameSpan = document.getElementById('user_nickname');

      if (isLoggedIn) {
        let decodedToken = decodeToken(token);
        console.log(decodeToken);
        let userNickname = decodedToken.nickname;
        console.log(userNickname);
        let userId = decodedToken.id;
        console.log(userId);

        if (loginButton) loginButton.style.display = 'none';
        if (logoutButton) logoutButton.style.display = 'block';
        if (myMenu) myMenu.style.display = 'block';

        if (userNicknameSpan) userNicknameSpan.innerText = userNickname;

        doGetCartList(userId);
      } else {
        if (loginButton) loginButton.style.display = 'block';
        if (logoutButton) logoutButton.style.display = 'none';
        if (myMenu) myMenu.style.display = 'none';
      }
    }

    function decodeToken(token) {
      const base64Url = token.split('.')[1];
      const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
      const jsonPayload = decodeURIComponent(atob(base64).split('').map(c => '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2)).join(''));

      return JSON.parse(jsonPayload);
    }


    function logout() {
      window.localStorage.removeItem('token');
      toggleMenu();
    }

    const doGetCartList = async (userId) => {
      try {
        let cartList = await getCartList(userId);
        console.log(cartList);

        var vm = Vue.createApp({
          data() {
            return {
              cartList: cartList,
            };
          },
        }).mount("#cartTableBody");
      } catch (error) {
        console.error("Error rendering cart list:", error);
      }
    };

    window.onload = toggleMenu;
  </script>
   <script>
    let token = window.localStorage.getItem('token');
    var isLoggedIn = token !== null;

    function toggleMenu() {
      var loginButton = document.getElementById('btn_login');
      var logoutButton = document.getElementById('btn_logout');
      var myMenu = document.getElementById('sub_mymenu');
      var userNicknameSpan = document.getElementById('user_nickname');

      if (isLoggedIn) {
        let decodedToken = decodeToken(token);
        let userNickname = decodedToken.nickname;

        if (loginButton) loginButton.style.display = 'none';
        if (logoutButton) logoutButton.style.display = 'block';
        if (myMenu) myMenu.style.display = 'block';

        if (userNicknameSpan) userNicknameSpan.innerText = userNickname;
      } else {
        if (loginButton) loginButton.style.display = 'block';
        if (logoutButton) logoutButton.style.display = 'none';
        if (myMenu) myMenu.style.display = 'none';
      }
    }

    // Function to decode JWT token
    function decodeToken(token) {
      const base64Url = token.split('.')[1];
      const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
      const jsonPayload = decodeURIComponent(atob(base64).split('').map(c => '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2)).join(''));

      return JSON.parse(jsonPayload);
    }

    function logout() {
      window.localStorage.removeItem('token');
      toggleMenu();
    }

    // 페이지 로드 시 함수 실행
    window.onload = toggleMenu;
  </script>
  <script>
    window.onscroll = function () { scrollFunction() };

    function scrollFunction() {
      if (document.body.scrollTop > 100 || document.documentElement.scrollTop > 100) {
        document.getElementById("scrollTopPc").style.display = "block";
        document.getElementById("scrollTopMob").style.display = "block";
        document.getElementById("scrollDownPc").style.display = "block";
        document.getElementById("scrollDownMob").style.display = "block";
      } else {
        document.getElementById("scrollTopPc").style.display = "none";
        document.getElementById("scrollTopMob").style.display = "none";
        document.getElementById("scrollDownPc").style.display = "none";
        document.getElementById("scrollDownMob").style.display = "none";
      }
    }

    // PC TOP 버튼 동작
    function topFunction() {
      $('html,body').animate({ scrollTop: 0 }, 500);
    }
    // 모바일 TOP 버튼 동작
    function topFunctionMob() {
      $('html,body').animate({ scrollTop: 0 }, 500);
    }
    // PC DOWN 버튼 동작
    function downFunction() {
      // 수정된 부분: '#doz_footer' 대신에 'body'로 스크롤
      $('html, body').animate({ scrollTop: $('body').height() }, 500);
    }
    // 모바일 DOWN 버튼 동작
    function downFunctionMob() {
      // 수정된 부분: '#doz_footer' 대신에 'body'로 스크롤
      $('html, body').animate({ scrollTop: $('body').height() }, 500);
    }
  </script>
</body>

</html>